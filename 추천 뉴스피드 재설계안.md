# 추천 뉴스피드 재설계안



## 기존의 문제점

- **우한 폐렴**과 같은 **새로운 개념의 급상승 토픽**이 추천 뉴스피드에 반영되지 않는다.

- 관심있는 것과 무관한 것의 **뉴스피드 구성 빈부 격차가 심하다/심할 수 있다.**

- 현재 이를 보완하기 위한 IS(현재는 사용X) , **랜덤 스코어가 존재하나, 이가** **위 문제를 해결하고 있는가?**

  

## 고려사항

- 하루에 각각의 인포에서 어느정도의 게시물이 평균적으로 생성되는가

나머지 비율은 비슷하고, **동아리&모임, 진로&구인**이 독보적인 데이터양을 가지고 있음



- 현재 뉴스피드, 검색의 경우, 어느 정도 양을 가져와 게시물을 배치하는가

  {'공모전&행사': 293,
   '대학교': 617,
   '동아리&모임': 1879,
   '미사용': 0,
   '예외': 183,
   '자유': 0,
   '진로&구인': 7028}

  

- 또한 이러한 양은 평균적으로 어느정도의 기간을 포함하는가|
   (**평균 1달?, 좀 의외인건 진로구인도 한달이라는 점**)
  따라서, **시간적 지표로 제한할 필요는 없다고 판단.**

  {'공모전&행사': datetime.datetime(2020, 2, 13, 0, 0, 4),
   '대학교': datetime.datetime(2020, 2, 12, 11, 32, 41),
   '동아리&모임': datetime.datetime(2020, 2, 12, 1, 11),
   '미사용': datetime.datetime(2020, 3, 11, 18, 31, 56, 161155),
   '예외': datetime.datetime(2020, 2, 13, 0, 0),
   '자유': datetime.datetime(2020, 3, 11, 18, 31, 56, 161155),
   '진로&구인': datetime.datetime(2020, 2, 12, 0, 0, 3)}



# 개선 방안

개선 방안의 중점이 되는 부분은 다음과 같다.

- 관심도간의 빈부 격차를 줄인다.
- 후보군 선정에서 질을 높인다.
- 새로운 급상승 토픽 변화에 대해 모든 회원이 인지시키도록 한다.





## 추천 뉴스피드 후보군 변경



### 카테고리 별 분배

다른 한 카테고리 쪽으로 치중되지 않도록 각 카테고리에서 일정한 수(각 700개)만큼 각자 가져와서 수행하자.



### 제 1안, 카테고리별 후보군 선정1

신희재의 관심사 태그 리스트를 리스트로 만들어서 각 카테고리별 태그랑 FastText 유사도를 측정해보았다.

a += ['홍보원']*36
a += ['소식']*36
a += ['IT&컴퓨터']*26
a += ['행사']*23
a += ['마케팅']*19
a += ['취업&진로']*18
a += ['수강']*15
a += ['창업']*14
a += ['공모전&대외활동']*14
a += ['국제']*12

>>> >>> doc_sim(대학교,a) 0.5417502
>>> >>> doc_sim(동아리,a) 0.42238435
>>> >>> doc_sim(공모전,a) 0.5889176
>>> >>> doc_sim(진로,a) 0.6315713
>>> >>> doc_sim(자유,a) 0.49050707

실제 내 관심사랑 생각보다 얼추 비슷해보임

따라서, 후보군 선정때 해당 비율을 다음과 같이 반영해보자.

1. 전체 추천 뉴스피드 후보군 개수는 똑같이 맞춘다.
2. 가장 유사도가 높은 카테고리는 게시물양을 20% 증가, 낮은 카테고리는 20% 감소시킨다.
3. 정비례형식으로 순위가 중앙에 가까워질수록 퍼센트 비율을 감소시키기 정중앙에는 그대로 변화가 없게 한다.
4. 짝수일 경우, 중앙 2개의 비율 변화를 없게 한다.

1위 20% 추가  **700 + 140 = 840**

2위 10% 추가  **700 + 70 = 770**

3위 그대로      **700**

4위 10% 감소  **700 - 70 = 630**

5위 10% 감소  **700 - 140  = 560**



## ~~제 2안, Tag를 이용한 후보군 선정2~~

### 결국 맨 처음 사태와 같은 후보군 선정으로 갖고 와버리게 됨(폐기)

최대 보관할 수 있는 태그 리스트를 확장시키고, 사용자가 접근한 정보의 태그들을 

하나라도 가진 게시물만 후보군으로 선정.

이때 사용자가 보유한 태그 약 20개 이하일 때를 Cold Start로 규정하고, 그 이후부터 시작.

**특징**

- 사용자의 관심사외에는 아예 후보로도 선정되지 않게 됨
- 사용자가 가진 태그가 모두 한 관심사에 관련되었을 경우, 굳어질 경우가 우려됨







## 추천 뉴스피드 평가 지표 개선



### TaS 평가를 좀더 두리뭉술하게 변경

1. 기존의 tag 갯수 / 전체 태그 합의 방식이었다면 완전히 다 풀고 순수 교집합 개수로 대입
2. 최대 보관 태그 리스트를 50개로 확장.
3. 50개중 포함되는 태그의 갯수를 N/10 점등으로 가산. (최대 1점을 넘길 수 없음)



### IS 개선

현재의 IS는 실제 지표에 크게 기여를 하지 못할 거라 예상함,  맥스 뷰가 전체 조회수, 좋아요라는 너무 큰 수치가 아닌 좀 더 반영이 잘되는 지표로 변경할 필요가 있음.

**고려사항**: 아무리 인기있는 게시물이라도 사용자 개인에게는 관심이 없을 수 있다.

1안: 한달간 기록한 게시물당 평균 인기도보다 해당 게시물이 높을 경우, 전체 similarity의 1.3 ~ 1.5배 점수 증가 ? (정확한 수치는 미정)





## 관심사 측정 알고리즘 개선

관심사 측정을 백그라운드에서 최소 2시간에 한번 돌릴 것

### 관심사 측정을 위한 사용자 정보 수 제한 축소

현재 관심사를 측정하기 위해 존재하는 최대 양의 축소한다.

일반적으로 생각해볼 때,  <조회> <검색> <좋아요>  순으로 액션 빈도가 높은 것이라고 생각할 수 있으므로 각 갯수를 다음과 같이 지정한다

- 조회: 100		    -> 30% 반영
- 검색: 40                   -> 25% 반영
- 좋아요: 20               -> 35% 반영
- 뉴스피드 방문: 30 - > 10% 반영



### 관심사 제외 규칙 추가 - 노후도

각 데이터의 노후도 설정이 필요할 수 있다. 해당 데이터가 너무 오래되었을 경우, 점점 현재의 사용자의 실제 관심사가 멀어질 수도 있기 때문이다.

따라서 관심사 측정에서 제외되는 게시물의 조건은 다음과 같다.

​	1. 위에 명시된 최대 개수 제한을 넘을 경우, 오래된 순으로 관심 측정에서 제외한다.

 	2. 액션을 수행한 날짜가 너무 오래되었을 경우, 이를테면 30일이 초과되었을 경우에  최대 개수가 넘지 않았음에도 관심사 측정에서 제외한다. 
 	3. , 이미 해당 항목의 데이터 개수가 15% 이하일 경우, 2번과 같은 사유처럼 오래되었더라도 제거하지 않는다.



### Cold start 규정 개선

현재의 단순한 측정 갱신 횟수로 콜드 스타트를 판별하는 방식을 다음과 같이 변경한다.

- 관심사 측정을 위한 (조회, 검색, 좋아요)  총합 데이터 개수가 20개 안 넘을 경우, cold start라 규정



___________________

추천 뉴스피드 재설계는 여기까지 <

--------------------------------------------





## 제 2의 추천 지표 추가

### 실시간 인기 검색어 -> 실시간 인기 토픽으로 기능 강화

- 실시간 검색어 측정 빈도 시간을 1시간으로 증가
- 검색어 리스트를 30개로 확장, 각 검색어 빈도수 저장
- 각 검색어*빈도수로 단어 리스트를 만들어 실시간 인기 토픽 결정
- 시간순으로 정렬한 약 2주 이내의 게시물(최대 1만?개)를 대상으로 유사도 측정 + 랜덤 조금 포함
- 유사도가 가장 높은 게시물 리스트 확보, 20개 확보
- 추천 뉴스피드를 보여줄때 5개마다 1개씩 노출하도록 설정



## 제3의 추천 지표 추가

###  가장 최근에 접근한 게시물(좋아요, 조회)에 가장 가까운 게시물 1개

좋아요, 조회를 통틀어서 가장 최근에 접근한 게시물 1개와 최근 게시물 1만개 중, 가장 가까운 게시물 하나를 선별하여 미리 유저 테이블에 박아둔다.

- 이 게시물은 추천 뉴스피드 최상단 5개 중에 표시된다.
- 이 게시물은 추천 뉴스피드에 3번 등장후 , 해당 게시물은 다른 게시물로 바뀔때까지 등장하지 않는다.



## 검색 여과 처리

### 너무 길 경우 풀텍스트 검토

### 가까운 결과외에 너무 거리가 먼 결과 제외











